<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro Synkro</title>
    <link rel="stylesheet" href="./css/logInSign.css">
</head>

<body>
    <div class="container">
        <div class="wallpaper">
            <img src="./assets/imgs/SYNKRO (1).png" alt="">
        </div>
        <div class="box_dados">

            <div class="titulo"><label for="">Cadastro</label></div>

            <div class="group-input">
                <label for="ipt_nome_empresarial">Nome Empresarial:</label>
                <input type="text" name="" id="ipt_nome_empresarial">
            </div>

            <div class="group-input">
                <label for="ipt_nome_representante">Nome do Representante: </label>
                <input type="text" name="" id="ipt_nome_representante">
            </div>

            <div class="group-input">
                <label for="ipt_ispb">Código ISPB </label>
                <input type="number" name="" id="ipt_ispb">
            </div>

            <div class="group-input">
                <label for="ipt_email">E-mail Corporativo:</label>
                <input type="email" name="" id="ipt_email">
            </div>
            <div class="group-input">
                <label for="ipt_status">Status Operação:</label>
                <select name="ipt_status" id="ipt_status">
                    <option value="em-operacao">Em operação</option>
                    <option value="liquidado-extrajudicialmente">Liquidado Extrajudicialmente</option>
                    <option value="liquidacao-ordinaria">Liquidação Ordinária</option>
                </select>
            </div>
            <div class="group-button">
                <span>Já possui acesso? <label>Faça login!</label></span>
                <button onclick="cadastrar()">Cadastrar</button>
            </div>
        </div>
    </div>

</body>

<script>
    function cadastrar() {
        var nomeEmpresarialVar = ipt_nome_empresarial.value;
        var nomeRepresentanteVar = ipt_nome_representante.value;
        var ispbVar = ipt_ispb.value;
        var emailVar = ipt_email.value;
        var statusOperacaoVar = ipt_status.value;
        // var senhaVar = ipt_senha.value;
        // var confirmacaoSenhaVar = ipt_confirmacao_senha.value;
        // var cargoVar = ipt_cargo.value;

        if (
            nomeEmpresarialVar == "" ||
            nomeRepresentanteVar == "" ||
            ispbVar == "" ||
            emailVar == ""
            // statusOperacaoVar == "#"
        ) {
            // ERRO
            console.log("Preencha todos os campos")
        } else if (
            nomeEmpresarialVar.length <= 2 ||
            nomeRepresentanteVar.length <= 2 ||
            ispbVar.length > 8 ||
            emailVar.length <= 2 ||
            !emailVar.includes("@") ||
            !emailVar.includes(".")
            // senhaVar.length <= 5 ||
            // confirmacaoSenhaVar.length != senhaVar
        ) {
            // ERRO
            console.log("Preenchimento inadequado / Campos inválidos")
        } else {
            console.log("CADASTRO OK")


            fetch("/cadastroEmpresa/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    nomeEmpresarialServer: nomeEmpresarialVar,
                    nomeRepresentanteServer: nomeRepresentanteVar,
                    ispbServer: ispbVar,
                    emailServer: emailVar,
                    statusOperacaoServer: statusOperacaoVar
                })
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {
                        console.log("cadastro realizado com sucesso")
                        console.log("redirecionando para tela de login")
                    } else {
                        throw "Houve um erro ao tentar realizar o cadastro!";
                    }
                })
                .catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);
                });
        }
    }
</script>

</html>